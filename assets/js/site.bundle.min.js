(function(){ "use strict"; const $ = (sel, ctx=document)=>ctx.querySelector(sel); const $$ = (sel, ctx=document)=>Array.prototype.slice.call(ctx.querySelectorAll(sel)); const THEME_KEY = "ui-theme"; function applyTheme(mode){ const m = (mode==="light"||mode==="dark") ? mode : "dark"; document.documentElement.setAttribute("data-theme", m); try { localStorage.setItem(THEME_KEY, m); } catch(e){} } function getTheme(){ try { return localStorage.getItem(THEME_KEY) || "dark"; } catch(e){ return "dark"; } } try { if (!$(".ui-theme-fab")) { const btn = document.createElement("button"); btn.type = "button"; btn.className = "ui-theme-fab"; btn.setAttribute("aria-label", "Toggle theme"); btn.innerHTML = '<svg width="22" height="22" viewBox="0 0 24 24" aria-hidden="true"><path d="M21.64 13A9 9 0 1111 2.36 7 7 0 0021.64 13z" fill="currentColor"/></svg>'; btn.addEventListener("click", function(){ const next = getTheme()==="dark" ? "light" : "dark"; applyTheme(next); }); document.body.appendChild(btn); } } catch(e){ } try { const header = $("header.site-header") || $(".site-header") || $("header[role='banner']") || $("header"); if (header) { const onScroll = () => { if (window.scrollY > 8) header.classList.add("is-scrolled"); else header.classList.remove("is-scrolled"); }; document.addEventListener("scroll", onScroll, {passive:true}); onScroll(); } } catch(e){ } try { const openers = $$("[data-ui-open]"); const closers = $$("[data-ui-close]"); openers.forEach(btn => btn.addEventListener("click", () => { const sel = btn.getAttribute("data-ui-open"); const panel = sel ? $(sel) : null; if (panel) panel.classList.remove("u-hidden"); })); closers.forEach(btn => btn.addEventListener("click", () => { const sel = btn.getAttribute("data-ui-close"); const panel = sel ? $(sel) : null; if (panel) panel.classList.add("u-hidden"); })); } catch(e){ } try { $$("img").forEach(img => { if (!img.hasAttribute("loading")) img.setAttribute("loading","lazy"); if (!img.hasAttribute("decoding")) img.setAttribute("decoding","async"); }); } catch(e){ } })(); (function(){ if(window.__gb_account_mobile_v3) return; window.__gb_account_mobile_v3 = true; const path = (location.pathname || '').toLowerCase(); const looksLikeAccount = /\/account(\.php)?$/.test(path); const tables = document.querySelectorAll('.table.responsive'); const heading = document.querySelector('h1, h2, .page-title'); const isArabicAccount = heading && /حسابي|الحساب|ملفي/.test((heading.textContent||'').trim()); const isAccount = looksLikeAccount || (tables.length >= 1 && isArabicAccount); if(!isAccount) return; document.body.classList.add('is-account-page'); tables.forEach(tbl => { const headRow = tbl.querySelector('thead tr'); if(!headRow) return; const labels = Array.from(headRow.children).map(th => (th.textContent||'').trim()); tbl.querySelectorAll('tbody tr').forEach(tr => { Array.from(tr.children).forEach((td, i) => { if(!td.getAttribute('data-label')) td.setAttribute('data-label', labels[i] || ''); }); }); }); })(); (function(){ const orderForm = document.querySelector('#orderForm'); if(orderForm){ function syncPkg(){ const sel = document.querySelector('input[name="pkg"]:checked'); const hidden = orderForm.querySelector('input[name="package"]') || orderForm.querySelector('input[name="package_id"]'); if (sel && hidden) hidden.value = sel.value; } document.addEventListener('change', (e)=>{ if(e.target && e.target.matches('input[name="pkg"]')) syncPkg(); }); syncPkg(); orderForm.addEventListener('submit', (e)=>{ if(!orderForm.checkValidity()){ e.preventDefault(); orderForm.reportValidity(); if(window.showToast) showToast('يرجى تعبئة الحقول المطلوبة'); return; } if(orderForm.hasAttribute('data-preview')){ e.preventDefault(); const fd = new FormData(orderForm); const data = Object.fromEntries(fd.entries()); const receipt = document.getElementById('receipt'); if (receipt){ receipt.innerHTML = ` <div class="form mt-3"> <h3>تم استلام طلبك ✅</h3> <p class="note">سنقوم بمراجعة الطلب وتنفيذه في أقرب وقت.</p> <hr style="opacity:.2;margin:12px 0"> <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px"> ${data.service ? `<div><strong>الخدمة:</strong> ${data.service}</div>`:''} ${(data.package||data.package_id) ? `<div><strong>الباقة:</strong> ${(data.package||data.package_id)}</div>`:''} ${data.player_id ? `<div><strong>معرّف اللاعب:</strong> ${data.player_id}</div>`:''} ${data.server ? `<div><strong>السيرفر/المنطقة:</strong> ${data.server}</div>`:''} ${data.network ? `<div><strong>الشبكة:</strong> ${data.network}</div>`:''} ${data.sender_phone ? `<div><strong>رقم المُرسل:</strong> ${data.sender_phone}</div>`:''} ${data.amount_sent ? `<div><strong>المبلغ المُرسل:</strong> ${data.amount_sent} د.ل</div>`:''} ${data.note ? `<div style="grid-column:1 / -1"><strong>ملاحظة:</strong> ${data.note}</div>`:''} </div> </div>`; receipt.classList.remove('hidden'); } if(window.showToast) showToast('تم إنشاء ملخص الطلب'); return; } }); } document.addEventListener('click', function(e){ const btn = e.target.closest('.fav-btn'); if(!btn || !btn.dataset.service) return; fetch('ajax/fav_toggle.php', { method:'POST', headers:{'Content-Type':'application/x-www-form-urlencoded; charset=UTF-8','X-Requested-With':'XMLHttpRequest'}, body:new URLSearchParams({service_id:btn.dataset.service}) }) .then(r=>r.json()) .then(d=>{ if(d && d.ok){ btn.classList.toggle('active', d.state==='added'); if(window.showToast) showToast(d.state==='added'?'أضيفت إلى المفضلة ♥':'أزيلت من المفضلة'); }else if(d && d.error==='login_required'){ location.href='login.php?next='+encodeURIComponent(location.href); } }) .catch(()=>{}); }, {passive:false}); document.addEventListener('DOMContentLoaded', function(){ const buyBtn=document.getElementById('buyNow'), sheet=document.getElementById('buySheet'), backdrop=document.getElementById('sheetBackdrop'), sheetClose=document.getElementById('sheetClose'), sheetPkg=document.getElementById('sheetPkg'), sheetPrice=document.getElementById('sheetPrice'), sheetConfirm=document.getElementById('sheetConfirm'), slug=(new URLSearchParams(location.search)).get('slug')||''; function open(){ if(!sheet) return; sheet.classList.add('open'); if(backdrop) backdrop.classList.add('show'); document.body.style.overflow='hidden'} function close(){ if(!sheet) return; sheet.classList.remove('open'); if(backdrop) backdrop.classList.remove('show'); document.body.style.overflow=''} if(buyBtn && sheet){ buyBtn.addEventListener('click', function(){ const sel=document.querySelector('input[name="pkg"]:checked'); if(!sel){ if(window.showToast) showToast('اختر الباقة أولاً'); return; } const label=sel.closest('.card')?.querySelector('.title')?.textContent.trim()||'', price=sel.dataset.price||''; if(sheetPkg) sheetPkg.textContent=label; if(sheetPrice) sheetPrice.textContent=price+' '+(window.CURRENCY||''); if(sheetConfirm) sheetConfirm.href='order.php?slug='+encodeURIComponent(slug)+'&pid='+encodeURIComponent(sel.value); open(); }); [sheetClose,backdrop].forEach(el=> el && el.addEventListener('click', close)); document.addEventListener('keydown', e=>{ if(e.key==='Escape') close(); }); } }); })(); (function(){ const meta = document.getElementById('orderMeta'); const form = document.getElementById('orderForm'); if(!meta || !form) return; const cat = meta.dataset.category || 'game'; const needsId = meta.dataset.requiresId === '1'; const needsAcc = meta.dataset.requiresAccount === '1'; const wrapPlayer = document.getElementById('wrap_player_id'); const playerInput = form.querySelector('input[name="player_id"]'); const wrapServer = document.getElementById('wrap_server'); const wrapMethod = document.getElementById('wrap_method'); const methodRadios = form.querySelectorAll('input[name="fulfill_method"]'); const wrapWhats = document.getElementById('wrap_whatsapp'); const inWhats = form.querySelector('input[name="whatsapp"]'); const wrapAcc = document.getElementById('wrap_account'); const inEmail = form.querySelector('input[name="account_email"]'); const inPass = form.querySelector('input[name="account_password"]'); function show(el, on){ if(!el) return; el.hidden = !on; if(!on){ el.querySelectorAll('input,select,textarea').forEach(i=>i.required=false);} } function req(i, on){ if(!i) return; i.required = !!on; } function apply(){ const isGame = cat === 'game'; const isSub = cat === 'subscription'; const isApp = cat === 'app'; const idMode = needsId || isGame; show(wrapPlayer, idMode); show(wrapServer, idMode); req(playerInput, idMode); const accMode = needsAcc || isSub; show(wrapMethod, accMode); if(!accMode){ show(wrapWhats, false); show(wrapAcc, false); req(inWhats,false); req(inEmail,false); req(inPass,false); return; } let method = 'whatsapp'; methodRadios.forEach(r=>{ if(r.checked) method=r.value; }); if(method === 'whatsapp'){ show(wrapWhats, true); req(inWhats,true); show(wrapAcc, false); req(inEmail,false); req(inPass,false); }else{ show(wrapWhats, false); req(inWhats,false); show(wrapAcc, true); req(inEmail,true); req(inPass,true); } } methodRadios.forEach(r => r && r.addEventListener('change', apply)); apply(); })(); ; if(!window.__gb_order_init_v9){ window.__gb_order_init_v9=true; (function(){ const form=document.getElementById('orderForm'), meta=document.getElementById('orderMeta'); if(!form || !meta) return; const $=(s,sc)=> (sc||document).querySelector(s); function show(el,on){ if(!el) return; el.hidden=!on; if(!on) el.querySelectorAll('input,select,textarea').forEach(i=> i.required=false); } function req(i,on){ if(i) i.required=!!on; } function method(){ const r=form.querySelectorAll('input[name="fulfill_method"]'); let v='whatsapp'; r.forEach(x=>{ if(x.checked) v=x.value; }); return v; } function syncPkg(){ const sel=document.querySelector('input[name="pkg"]:checked'); const hid=form.querySelector('input[name="package_id"]')||form.querySelector('input[name="package"]'); if(sel&&hid) hid.value=sel.value; } const cat=meta.dataset.category||'game', needsId=meta.dataset.requiresId==='1', needsAcc=meta.dataset.requiresAccount==='1'; const wPlayer=document.getElementById('wrap_player_id'), inPlayer=$('input[name="player_id"]', form); const wServer=document.getElementById('wrap_server'), inServer=$('input[name="server"]', form); const wMethod=document.getElementById('wrap_method'); const wWhats=document.getElementById('wrap_whatsapp'), inWhats=$('input[name="whatsapp"]', form); const wAcc=document.getElementById('wrap_account'), inEmail=$('input[name="account_email"]', form), inPass=$('input[name="account_password"]', form); function apply(){ const isGame=(cat==='game'), isSub=(cat==='subscription'); const idMode=isGame || needsId, accMode=isSub || needsAcc; show(wPlayer, idMode); req(inPlayer,idMode); show(wServer, idMode && !!inServer); show(wMethod, accMode); if(accMode){ if(method()==='account'){ show(wWhats,false); req(inWhats,false); show(wAcc,true); req(inEmail,true); req(inPass,true); } else { show(wWhats,true); req(inWhats,true); show(wAcc,false); req(inEmail,false); req(inPass,false); } }else{ show(wWhats,false); req(inWhats,false); show(wAcc,false); req(inEmail,false); req(inPass,false); } } document.addEventListener('change', e=>{ if(e.target && e.target.name==='pkg') syncPkg(); if(e.target && e.target.name==='fulfill_method') apply(); }); document.addEventListener('DOMContentLoaded', ()=>{ apply(); syncPkg(); }); form.addEventListener('submit', e=>{ apply(); const hasPkg=!!document.querySelector('input[name="pkg"]'); if(hasPkg && !document.querySelector('input[name="pkg"]:checked')){ e.preventDefault(); (window.showToast?showToast('اختر الباقة أولاً'):alert('اختر الباقة أولاً')); return; } if(!form.checkValidity()){ e.preventDefault(); form.reportValidity(); (window.showToast?showToast('يرجى تعبئة الحقول المطلوبة'):0); return; } syncPkg(); }); })(); } ; if(!window.__gb_order_v10){ window.__gb_order_v10=true; (function(){ const form=document.getElementById('orderForm'), meta=document.getElementById('orderMeta'); if(!form || !meta) return; function applyNow(){ try{ const ev=new Event('change', {bubbles:true}); const m=form.querySelector('input[name="fulfill_method"]:checked'); if(m) m.dispatchEvent(ev); const p=document.querySelector('input[name="pkg"]:checked'); if(p) p.dispatchEvent(ev); }catch(e){} } document.addEventListener('input', (e)=>{ if(e.target && (e.target.name==='fulfill_method' || e.target.name==='pkg')) applyNow(); }, {passive:true}); document.addEventListener('DOMContentLoaded', applyNow); })(); } (function(){ if (window.__gb_mobile_enh) return; window.__gb_mobile_enh = true; const lazyImgs = [].slice.call(document.querySelectorAll('img.lazy[data-src]')); if ('IntersectionObserver' in window && lazyImgs.length){ const io = new IntersectionObserver((entries, obs)=>{ entries.forEach(e=>{ if(!e.isIntersecting) return; const img = e.target; img.src = img.dataset.src; img.removeAttribute('data-src'); img.classList.remove('lazy'); obs.unobserve(img); }); }, {rootMargin: '200px 0px'}); lazyImgs.forEach(img=> io.observe(img)); } else { lazyImgs.forEach(img=> { img.src = img.dataset.src; img.classList.remove('lazy'); }); } function enableDragScroll(rail){ let isDown=false, startX=0, scrollL=0, lockAxis=null, lastX=0, vx=0, raf=null; const onDown = (e)=>{ isDown=true; lockAxis=null; const x = (e.touches? e.touches[0].clientX : e.clientX); startX = x; lastX = x; scrollL = rail.scrollLeft; vx = 0; rail.classList.add('dragging'); }; const onMove = (e)=>{ if(!isDown) return; const x = (e.touches? e.touches[0].clientX : e.clientX); const dx = x - startX; const dy = (e.touches? e.touches[0].clientY : e.clientY) - (e.touches? e.touches[0].clientY : e.clientY); if(lockAxis === null){ if(Math.abs(dx) > 6){ lockAxis = 'x'; } } if(lockAxis === 'x'){ e.preventDefault(); rail.scrollLeft = scrollL - dx; vx = x - lastX; lastX = x; } }; const onUp = ()=>{ if(!isDown) return; isDown=false; rail.classList.remove('dragging'); const decay = ()=>{ rail.scrollLeft -= vx; vx *= 0.92; if (Math.abs(vx) > 0.5){ raf = requestAnimationFrame(decay); } }; cancelAnimationFrame(raf); if(Math.abs(vx) > 1) decay(); }; rail.addEventListener('mousedown', onDown, {passive:false}); rail.addEventListener('mousemove', onMove, {passive:false}); rail.addEventListener('mouseup', onUp, {passive:true}); rail.addEventListener('mouseleave', onUp, {passive:true}); rail.addEventListener('touchstart', onDown, {passive:false}); rail.addEventListener('touchmove', onMove, {passive:false}); rail.addEventListener('touchend', onUp, {passive:true}); rail.addEventListener('touchcancel', onUp, {passive:true}); } document.querySelectorAll('.cards-rail').forEach(enableDragScroll); const path = (location.pathname || '').toLowerCase(); document.querySelectorAll('.smart-tabbar .tab-item').forEach(a=>{ const href = (a.getAttribute('href')||'').toLowerCase(); if(href && path.indexOf(href) !== -1){ a.classList.add('is-active'); } }); })(); (function(){ const root = document.documentElement; const THEME_KEY = 'gb_theme'; const prefersDark = () => window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches; function setTheme(mode){ root.setAttribute('data-theme', mode); root.classList.toggle('light', mode === 'light'); try{ localStorage.setItem(THEME_KEY, mode); }catch(e){} updateThemeToggle(mode); } function getSavedTheme(){ try{ return localStorage.getItem(THEME_KEY); }catch(e){ return null; } } function initTheme(){ const pre = root.getAttribute('data-theme'); if (pre === 'light' || pre === 'dark'){ updateThemeToggle(pre); return; } const saved = getSavedTheme(); const mode = saved ? saved : (prefersDark() ? 'dark' : 'light'); setTheme(mode); } function updateThemeToggle(mode){ const btn = document.getElementById('themeToggle'); if(!btn) return; btn.dataset.mode = mode; btn.innerHTML = (mode === 'dark') ? '☀️' : '🌙'; btn.setAttribute('aria-label', mode==='dark' ? 'التبديل إلى الفاتح' : 'التبديل إلى الداكن'); } function initDrawer(){ const btn = document.getElementById('menuToggle'); const drawer = document.getElementById('sideMenu'); if(!btn || !drawer) return; let backdrop = document.getElementById('menuBackdrop'); if(!backdrop){ backdrop = document.createElement('div'); backdrop.id = 'menuBackdrop'; backdrop.className = 'drawer-backdrop'; document.body.appendChild(backdrop); } function open(){ if(drawer.parentElement !== document.body) document.body.appendChild(drawer); drawer.classList.add('open'); backdrop.classList.add('show'); drawer.setAttribute('aria-hidden','false'); document.body.style.overflow='hidden'; } function close(){ drawer.classList.remove('open'); backdrop.classList.remove('show'); drawer.setAttribute('aria-hidden','true'); document.body.style.overflow=''; } btn.addEventListener('click', open); backdrop.addEventListener('click', close); drawer.addEventListener('click', (e)=>{ if(e.target.closest('[data-close],a')) close(); }); document.addEventListener('keydown', (e)=>{ if(e.key==='Escape') close(); }); const src = document.querySelector('.nav'); const dst = drawer.querySelector('.drawer-nav'); if (src && dst && !dst.childElementCount) { const clone = src.cloneNode(true); clone.querySelectorAll('#themeToggle,#menuToggle').forEach(el=>el.remove()); dst.innerHTML = clone.innerHTML; } } function initTabbar(){ const current = (location.pathname || '/').replace(/\/+$/,'') || '/'; document.querySelectorAll('.tabbar a').forEach(a => { const href = (a.getAttribute('href') || '').replace(/\/+$/,''); if (!href) return; const isRoot = href === '' || href === '/' || href.endsWith('/index.php'); if ((isRoot && (current==='/' || current.endsWith('/index.php'))) || (!isRoot && current.endsWith(href))) { a.setAttribute('aria-current','page'); } }); } window.showToast = function(msg){ let el = document.querySelector('.toast'); if(!el){ el = document.createElement('div'); el.className = 'toast'; document.body.appendChild(el); } el.textContent = msg; el.classList.add('show'); clearTimeout(window.__toastTimer); window.__toastTimer = setTimeout(()=> el.classList.remove('show'), 2200); }; function initRipple(){ document.body.addEventListener('click', function(e){ const el = e.target.closest('.btn'); if(!el) return; const rect = el.getBoundingClientRect(); const circle = document.createElement('span'); const size = Math.max(rect.width, rect.height); circle.className = 'ripple'; circle.style.width = circle.style.height = size + 'px'; circle.style.left = (e.clientX - rect.left - size/2) + 'px'; circle.style.top = (e.clientY - rect.top - size/2) + 'px'; el.appendChild(circle); setTimeout(()=>circle.remove(), 600); }, {passive:true}); } function initLazyAndTopbar(){ document.querySelectorAll('img:not([loading])').forEach(img => img.loading='lazy'); const topbar = document.querySelector('.topbar, .header'); if(topbar){ const onScroll = () => topbar.classList.toggle('scrolled', window.scrollY > 6); onScroll(); window.addEventListener('scroll', onScroll, {passive:true}); } } function initCopy(){ document.body.addEventListener('click', async (e)=>{ const btn = e.target.closest('[data-copy]'); if(!btn) return; try{ await navigator.clipboard.writeText(btn.dataset.copy); const old = btn.textContent; btn.textContent = '✓ تم النسخ'; setTimeout(()=> btn.textContent = old, 1200); }catch(err){} }); } function initAmountChips(){ const container = document.querySelector('.amount-chips'); const amount = document.getElementById('amount'); if(!container || !amount) return; const chips = Array.from(container.querySelectorAll('.chip')); const activate = (val)=> chips.forEach(c => c.classList.toggle('active', parseFloat(c.dataset.amount) === parseFloat(val))); chips.forEach(ch => ch.addEventListener('click', ()=>{ amount.value = ch.dataset.amount; activate(amount.value); amount.focus(); })); if (amount.value) activate(amount.value); amount.addEventListener('input', ()=>{ const v = amount.value; const any = chips.some(c => parseFloat(c.dataset.amount) === parseFloat(v)); if (!any) chips.forEach(c => c.classList.remove('active')); else activate(v); }); } function initNoDoubleSubmit(){ document.addEventListener('submit', (e)=>{ const form = e.target.closest('form'); if(!form) return; const btn = form.querySelector('button[type="submit"], .btn[type="submit"]'); if(btn){ btn.disabled = true; const old = btn.textContent; btn.textContent = 'جارٍ الإرسال…'; setTimeout(()=>{ try{btn.disabled=false; btn.textContent = old;}catch(e){} }, 3000); } }); } document.addEventListener('DOMContentLoaded', function(){ initTheme(); initDrawer(); initTabbar(); initRipple(); initLazyAndTopbar(); initCopy(); initAmountChips(); initNoDoubleSubmit(); const themeBtn = document.getElementById('themeToggle'); if (themeBtn){ themeBtn.addEventListener('click', function(){ const current = root.getAttribute('data-theme') || (root.classList.contains('light') ? 'light' : 'dark'); const next = current === 'dark' ? 'light' : 'dark'; setTheme(next); if (typeof showToast === 'function') showToast(next==='dark' ? 'تم تفعيل النمط الداكن 🌙' : 'تم تفعيل النمط الفاتح ☀️'); }); } }); })(); ; if(!window.__gb_init_v9){ window.__gb_init_v9 = true; (function(){ const root=document.documentElement, KEY='gb_theme'; const $=(s,sc)=> (sc||document).querySelector(s); const $$=(s,sc)=> Array.from((sc||document).querySelectorAll(s)); function prefersDark(){ return window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches; } function setTheme(mode){ root.setAttribute('data-theme', mode); try{ localStorage.setItem(KEY, mode); }catch(e){} const t=$('#themeToggle'); if(t){ t.textContent=(mode==='dark'?'☀️':'🌙'); t.title=(mode==='dark'?'الوضع الفاتح':'الوضع الداكن'); } } (function initTheme(){ const pre=root.getAttribute('data-theme'); if(pre==='dark'||pre==='light'){ setTheme(pre); } else{ let s=null; try{s=localStorage.getItem(KEY);}catch(e){} setTheme(s? s : (prefersDark()?'dark':'light')); } })(); (function initDrawer(){ const btn=$('#menuToggle'), drawer=$('#sideMenu'); if(!btn||!drawer) return; let backdrop=$('#menuBackdrop'); if(!backdrop){ backdrop=document.createElement('div'); backdrop.id='menuBackdrop'; backdrop.className='drawer-backdrop'; document.body.appendChild(backdrop); } const open=()=>{ drawer.classList.add('open'); backdrop.classList.add('show'); document.body.style.overflow='hidden'; }; const close=()=>{ drawer.classList.remove('open'); backdrop.classList.remove('show'); document.body.style.overflow=''; }; btn.addEventListener('click', open, {passive:true}); backdrop.addEventListener('click', close, {passive:true}); drawer.addEventListener('click', e=>{ if(e.target.closest('[data-close],a')) close(); }); document.addEventListener('keydown', e=>{ if(e.key==='Escape') close(); }); const src=$('.nav'), dst=drawer.querySelector('.drawer-nav'); if(src && dst && !dst.childElementCount) dst.innerHTML=src.innerHTML; })(); (function initRipple(){ document.addEventListener('click', function(e){ const el=e.target.closest('.btn'); if(!el) return; const r=el.getBoundingClientRect(); const s=Math.max(r.width,r.height); const dot=document.createElement('span'); dot.className='ripple'; dot.style.width=dot.style.height=s+'px'; dot.style.left=(e.clientX-r.left - s/2)+'px'; dot.style.top=(e.clientY-r.top - s/2)+'px'; el.appendChild(dot); setTimeout(()=>dot.remove(), 600); }, {passive:true}); })(); (function initTopbar(){ $$('img:not([loading])').forEach(img=> img.loading='lazy'); const top=$('.topbar, .header'); if(top){ const on=()=> top.classList.toggle('scrolled', window.scrollY>6); on(); window.addEventListener('scroll', on, {passive:true}); } })(); (function initCopy(){ document.addEventListener('click', async e=>{ const x=e.target.closest('[data-copy]'); if(!x) return; try{ await navigator.clipboard.writeText(x.dataset.copy||''); const o=x.textContent; x.textContent='✓ تم النسخ'; setTimeout(()=>x.textContent=o, 1100); }catch(e){} }, {passive:true}); })(); (function initAmountChips(){ const wrap=document.querySelector('.amount-chips'), amount=document.getElementById('amount'); if(!wrap||!amount) return; const chips=$$('.chip', wrap); const activate=v=> chips.forEach(c=> c.classList.toggle('active', parseFloat(c.dataset.amount)===parseFloat(v))); chips.forEach(c=> c.addEventListener('click', ()=>{ amount.value=c.dataset.amount; activate(amount.value); amount.focus(); })); if(amount.value) activate(amount.value); amount.addEventListener('input', ()=>{ const v=amount.value; const any=chips.some(c=>parseFloat(c.dataset.amount)===parseFloat(v)); any?activate(v):chips.forEach(c=>c.classList.remove('active')); }); })(); (function guardForms(){ document.addEventListener('submit', e=>{ const f=e.target.closest('form'); if(!f) return; const b=f.querySelector('button[type="submit"], .btn[type="submit"]'); if(!b) return; b.disabled=true; const t=b.textContent; b.textContent='جارٍ الإرسال…'; setTimeout(()=>{ try{b.disabled=false; b.textContent=t;}catch(e){} }, 3000); }); })(); window.showToast=function(msg){ let el=document.querySelector('.toast'); if(!el){ el=document.createElement('div'); el.className='toast'; document.body.appendChild(el); } el.textContent=msg; el.classList.add('show'); clearTimeout(window.__toastTimer); window.__toastTimer=setTimeout(()=>el.classList.remove('show'),2200); }; })(); } ; if(!window.__gb_effects_v10){ window.__gb_effects_v10 = true; (function(){ const root=document.documentElement, CONTRAST_KEY='gb_contrast'; const $=(s,sc)=> (sc||document).querySelector(s); const $$=(s,sc)=> Array.from((sc||document).querySelectorAll(s)); function setContrast(mode){ if(!mode){ root.removeAttribute('data-contrast'); } else{ root.setAttribute('data-contrast', 'high'); } try{ localStorage.setItem(CONTRAST_KEY, mode?'high':'off'); }catch(e){} const b=$('#contrastToggle'); if(b){ b.textContent = (mode?'🌓 تباين عالٍ':'◐ تباين افتراضي'); } } function initContrast(){ let saved=null; try{ saved=localStorage.getItem(CONTRAST_KEY);}catch(e){} setContrast(saved==='high'); const btn=$('#contrastToggle'); if(btn){ btn.addEventListener('click', ()=> setContrast(root.getAttribute('data-contrast')!=='high'), {passive:true}); } } function initReveal(){ const els=$$('[data-animate]'); if(!els.length) return; const io=new IntersectionObserver((entries)=>{ entries.forEach(ent=>{ if(ent.isIntersecting){ ent.target.classList.add('is-visible'); io.unobserve(ent.target); } }); }, {rootMargin:'-10% 0px -5% 0px', threshold:.1}); els.forEach(el=> io.observe(el)); } function initPress(){ document.addEventListener('mousedown', (e)=>{ const t=e.target.closest('[data-press]'); if(!t) return; t.style.transform='scale(.98)'; }); document.addEventListener('mouseup', ()=>{ $$('[data-press]').forEach(el=> el.style.transform=''); }); document.addEventListener('mouseleave', ()=>{ $$('[data-press]').forEach(el=> el.style.transform=''); }); } document.addEventListener('DOMContentLoaded', function(){ initContrast(); initReveal(); initPress(); }); })(); } ; if(!window.__gb_fx_v10_2){ window.__gb_fx_v10_2 = true; (function(){ const $=(s,sc)=> (sc||document).querySelector(s); const $$=(s,sc)=> Array.from((sc||document).querySelectorAll(s)); function autoAnimate(){ const candidates = $$('.card, .service-card, .product, .section, .grid > *'); candidates.forEach(el=>{ if(!el.hasAttribute('data-animate')){ el.setAttribute('data-animate',''); el.classList.add('fx-pop'); } }); } function initReveal(){ const els=$$('[data-animate]'); if(!els.length) return; const io=new IntersectionObserver((entries)=>{ entries.forEach(ent=>{ if(ent.isIntersecting){ ent.target.classList.add('is-visible'); io.unobserve(ent.target); } }); }, {rootMargin:'-10% 0px -5% 0px', threshold:.1}); els.forEach(el=> io.observe(el)); } function initRippleUniversal(){ document.addEventListener('click', function(e){ const el = e.target.closest('.btn, .chip'); if(!el) return; const r = el.getBoundingClientRect(); const size=Math.max(r.width,r.height); const dot=document.createElement('span'); dot.className='ripple'; dot.style.width=dot.style.height=size+'px'; dot.style.left=(e.clientX-r.left - size/2)+'px'; dot.style.top =(e.clientY-r.top - size/2)+'px'; el.appendChild(dot); setTimeout(()=>dot.remove(), 600); }, {passive:true}); } function initPressUniversal(){ document.addEventListener('pointerdown', e=>{ const t=e.target.closest('.btn'); if(!t) return; t.style.transform='scale(.98)'; }); document.addEventListener('pointerup', ()=>{ $$('.btn').forEach(b=> b.style.transform=''); }); document.addEventListener('pointercancel', ()=>{ $$('.btn').forEach(b=> b.style.transform=''); }); document.addEventListener('mouseleave', ()=>{ $$('.btn').forEach(b=> b.style.transform=''); }); } document.addEventListener('DOMContentLoaded', function(){ autoAnimate(); initReveal(); initRippleUniversal(); initPressUniversal(); }); })(); } ; if(!window.__gb_final_v11){ window.__gb_final_v11 = true; (function(){ const root = document.documentElement; const THEME_KEY = 'gb_theme'; const $ = (s,sc)=> (sc||document).querySelector(s); const $$ = (s,sc)=> Array.from((sc||document).querySelectorAll(s)); function setTheme(mode){ root.setAttribute('data-theme', mode); try{ localStorage.setItem(THEME_KEY, mode); }catch(e){} root.classList.add('theme-animating'); clearTimeout(window.__gbThemeTimer); window.__gbThemeTimer = setTimeout(()=> root.classList.remove('theme-animating'), 340); $$('#themeToggle,[data-theme-toggle]').forEach(btn=>{ if(btn && !btn.dataset.lockLabel){ btn.textContent = (mode==='dark' ? '☀️' : '🌙'); btn.title = (mode==='dark' ? 'الوضع الفاتح' : 'الوضع الداكن'); } }); } function initTheme(){ const pre = root.getAttribute('data-theme'); if(pre==='dark' || pre==='light'){ setTheme(pre); return; } let saved=null; try{ saved = localStorage.getItem(THEME_KEY); }catch(e){} if(saved){ setTheme(saved); } else{ const dark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches; setTheme(dark ? 'dark' : 'light'); } } function bindThemeToggle(){ function onToggle(e){ const t = e.target.closest('#themeToggle,[data-theme-toggle]'); if(!t) return; e.preventDefault(); e.stopPropagation(); const next = (root.getAttribute('data-theme')==='dark' ? 'light' : 'dark'); setTheme(next); } document.addEventListener('click', onToggle); document.addEventListener('pointerup', onToggle); document.addEventListener('keydown', (e)=>{ const t = e.target.closest('#themeToggle,[data-theme-toggle]'); if(!t) return; if(e.key==='Enter' || e.key===' '){ e.preventDefault(); const next=(root.getAttribute('data-theme')==='dark'?'light':'dark'); setTheme(next); } }); } function ensureBackdrop(){ let b = $('#menuBackdrop'); if(!b){ b = document.createElement('div'); b.id='menuBackdrop'; b.className='drawer-backdrop'; document.body.appendChild(b); } return b; } function findDrawer(fromControl){ if(fromControl && fromControl.getAttribute('aria-controls')){ const id = fromControl.getAttribute('aria-controls'); const el = document.getElementById(id); if(el) return el; } return $('#sideMenu') || $('[data-drawer]') || $('.drawer') || $('.side-menu'); } function openDrawer(drawer, backdrop){ if(!drawer) return; drawer.classList.add('open'); if(backdrop) backdrop.classList.add('show'); document.body.classList.add('menu-open'); document.body.style.overflow='hidden'; drawer.setAttribute('aria-hidden','false'); } function closeDrawer(drawer, backdrop){ if(!drawer) return; drawer.classList.remove('open'); if(backdrop) backdrop.classList.remove('show'); document.body.classList.remove('menu-open'); document.body.style.overflow=''; drawer.setAttribute('aria-hidden','true'); } function initMenu(){ const backdrop = ensureBackdrop(); function delegatedHandler(e){ const openBtn = e.target.closest('#menuToggle,[data-menu-toggle],.menu-toggle'); if(openBtn){ e.preventDefault(); e.stopPropagation(); const drawer = findDrawer(openBtn); if(drawer){ openDrawer(drawer, backdrop); } return; } if(e.target === backdrop){ closeDrawer(findDrawer(), backdrop); return; } const closeBtn = e.target.closest('[data-close], .drawer a, .side-menu a'); if(closeBtn){ closeDrawer(findDrawer(closeBtn), backdrop); return; } } document.addEventListener('click', delegatedHandler); document.addEventListener('keydown', (e)=>{ if(e.key==='Escape'){ closeDrawer(findDrawer(), backdrop); } }); } function initTopbarShadow(){ const top = $('.topbar, .header'); if(!top) return; const on=()=> top.classList.toggle('scrolled', window.scrollY>6); on(); window.addEventListener('scroll', on, {passive:true}); } function initRipple(){ if(window.__gb_fx_ripple_v11) return; window.__gb_fx_ripple_v11 = true; document.addEventListener('click', function(e){ const el = e.target.closest('.btn, .chip'); if(!el) return; const r = el.getBoundingClientRect(); const size=Math.max(r.width,r.height); const dot=document.createElement('span'); dot.className='ripple'; Object.assign(dot.style, { position:'absolute', borderRadius:'50%', transform:'scale(0)', animation:'ripple .6s linear', background:'rgba(255,255,255,.35)', pointerEvents:'none', opacity:'.9', width:size+'px', height:size+'px', left:(e.clientX-r.left - size/2)+'px', top:(e.clientY-r.top - size/2)+'px' }); if(getComputedStyle(el).position === 'static'){ el.style.position='relative'; } el.appendChild(dot); setTimeout(()=>dot.remove(), 650); }, {passive:true}); } document.addEventListener('DOMContentLoaded', function(){ initTheme(); bindThemeToggle(); initMenu(); initTopbarShadow(); initRipple(); }); })(); } ; if(!window.__gb_final_v11_1){ window.__gb_final_v11_1 = true; (function(){ const $ = (s,sc)=> (sc||document).querySelector(s); const $$ = (s,sc)=> Array.from((sc||document).querySelectorAll(s)); function ensureBackdrop(){ let b = $('#menuBackdrop'); if(!b){ b = document.createElement('div'); b.id='menuBackdrop'; b.className='drawer-backdrop'; document.body.appendChild(b); } return b; } function findDrawer(fromControl){ if(fromControl && fromControl.getAttribute && fromControl.getAttribute('aria-controls')){ const id = fromControl.getAttribute('aria-controls'); const el = document.getElementById(id); if(el) return el; } return $('#sideMenu') || $('[data-drawer]') || $('.drawer') || $('.side-menu'); } function isOpen(d){ return d && d.classList.contains('open'); } function openDrawer(d, backdrop, btn){ if(!d) return; d.classList.add('open'); d.setAttribute('aria-hidden','false'); document.body.classList.add('menu-open'); document.body.style.overflow='hidden'; if(backdrop) backdrop.classList.add('show'); if(btn) btn.setAttribute('aria-expanded','true'); } function closeDrawer(d, backdrop, btn){ if(!d) return; d.classList.remove('open'); d.setAttribute('aria-hidden','true'); document.body.classList.remove('menu-open'); document.body.style.overflow=''; if(backdrop) backdrop.classList.remove('show'); if(btn) btn.setAttribute('aria-expanded','false'); } function initMenu(){ const backdrop = ensureBackdrop(); const toggles = [ ...$$('#menuToggle'), ...$$('[data-menu-toggle]'), ...$$('.menu-toggle') ]; const drawer = findDrawer(toggles[0]); toggles.forEach(btn=>{ btn.setAttribute('aria-controls', drawer ? (drawer.id || 'sideMenu') : 'sideMenu'); btn.setAttribute('aria-expanded','false'); btn.addEventListener('click', (e)=>{ e.preventDefault(); e.stopPropagation(); const d = findDrawer(btn); if(!d) return; isOpen(d) ? closeDrawer(d, backdrop, btn) : openDrawer(d, backdrop, btn); }); }); backdrop.addEventListener('click', ()=> closeDrawer(findDrawer(), backdrop, toggles[0])); document.addEventListener('keydown', (e)=>{ if(e.key==='Escape'){ closeDrawer(findDrawer(), backdrop, toggles[0]); } }); document.addEventListener('mousedown', (e)=>{ const d = findDrawer(); if(!d || !isOpen(d)) return; if(!e.target.closest('.drawer, .side-menu') && !e.target.closest('#menuToggle,[data-menu-toggle],.menu-toggle')){ closeDrawer(d, backdrop, toggles[0]); } }, true); const d2 = findDrawer(); if(d2){ d2.addEventListener('click', (e)=>{ if(e.target.closest('[data-close], a, button[data-close]')){ closeDrawer(d2, backdrop, toggles[0]); } }); } let lastW = window.innerWidth; window.addEventListener('resize', ()=>{ const w = window.innerWidth; if(w >= 1024 && w !== lastW){ closeDrawer(findDrawer(), backdrop, toggles[0]); } lastW = w; }); } function initBackToTop(){ let btn = document.getElementById('backToTop'); if(!btn){ btn = document.createElement('button'); btn.id = 'backToTop'; btn.type = 'button'; btn.setAttribute('aria-label','العودة للأعلى'); btn.innerHTML = '↑'; document.body.appendChild(btn); } const onScroll = ()=>{ if(window.scrollY > 260){ btn.classList.add('show'); } else { btn.classList.remove('show'); } }; onScroll(); window.addEventListener('scroll', onScroll, {passive:true}); btn.addEventListener('click', ()=> window.scrollTo({top:0, behavior:'smooth'})); } document.addEventListener('DOMContentLoaded', function(){ initMenu(); initBackToTop(); }); })(); } ; if(!window.__gb_final_v11_2){ window.__gb_final_v11_2 = true; (function(){ const $ = (s,sc)=> (sc||document).querySelector(s); const $$ = (s,sc)=> Array.from((sc||document).querySelectorAll(s)); function ensureBackdrop(){ let b = $('#menuBackdrop'); if(!b){ b = document.createElement('div'); b.id='menuBackdrop'; b.className='drawer-backdrop'; document.body.appendChild(b); } return b; } function findDrawer(fromControl){ if(fromControl && fromControl.getAttribute && fromControl.getAttribute('aria-controls')){ const id = fromControl.getAttribute('aria-controls'); const el = document.getElementById(id); if(el) return el; } return $('#sideMenu') || $('[data-drawer]') || $('.drawer') || $('.side-menu'); } function isOpen(d){ return d && d.classList.contains('open'); } function openDrawer(d, backdrop, btn){ if(!d) return; d.classList.add('open'); d.setAttribute('aria-hidden','false'); document.body.classList.add('menu-open'); document.body.style.overflow='hidden'; if(backdrop) backdrop.classList.add('show'); if(btn) btn.setAttribute('aria-expanded','true'); } function closeDrawer(d, backdrop, btn){ if(!d) return; d.classList.remove('open'); d.setAttribute('aria-hidden','true'); document.body.classList.remove('menu-open'); document.body.style.overflow=''; if(backdrop) backdrop.classList.remove('show'); if(btn) btn.setAttribute('aria-expanded','false'); } function initMenu(){ const backdrop = ensureBackdrop(); const toggles = [ ...$$('#menuToggle'), ...$$('[data-menu-toggle]'), ...$$('.menu-toggle') ]; const drawer = findDrawer(toggles[0]); if(drawer && !drawer.classList.contains('drawer--left') && !drawer.classList.contains('drawer--right')){ const isRTL = document.documentElement.getAttribute('dir') === 'rtl'; drawer.classList.add(isRTL ? 'drawer--right' : 'drawer--left'); } toggles.forEach(btn=>{ if(!drawer) return; if(!drawer.id) drawer.id = 'sideMenu'; btn.setAttribute('aria-controls', drawer.id); btn.setAttribute('aria-expanded','false'); btn.addEventListener('click', (e)=>{ e.preventDefault(); e.stopPropagation(); const d = findDrawer(btn); if(!d) return; isOpen(d) ? closeDrawer(d, backdrop, btn) : openDrawer(d, backdrop, btn); }); }); backdrop.addEventListener('click', ()=> closeDrawer(findDrawer(), backdrop, toggles[0])); document.addEventListener('keydown', (e)=>{ if(e.key==='Escape'){ closeDrawer(findDrawer(), backdrop, toggles[0]); } }); document.addEventListener('mousedown', (e)=>{ const d = findDrawer(); if(!d || !isOpen(d)) return; if(!e.target.closest('.drawer, .side-menu') && !e.target.closest('#menuToggle,[data-menu-toggle],.menu-toggle')){ closeDrawer(d, backdrop, toggles[0]); } }, true); const d2 = findDrawer(); if(d2){ d2.addEventListener('click', (e)=>{ if(e.target.closest('[data-close], a, button[data-close]')){ closeDrawer(d2, backdrop, toggles[0]); } }); } if(drawer){ closeDrawer(drawer, ensureBackdrop(), toggles[0]); } } function initBackToTop(){ let btn = document.getElementById('backToTop'); if(!btn){ btn = document.createElement('button'); btn.id = 'backToTop'; btn.type = 'button'; btn.setAttribute('aria-label','العودة للأعلى'); btn.innerHTML = '↑'; document.body.appendChild(btn); } const onScroll = ()=>{ if(window.scrollY > 260){ btn.classList.add('show'); } else { btn.classList.remove('show'); } }; onScroll(); window.addEventListener('scroll', onScroll, {passive:true}); btn.addEventListener('click', ()=> window.scrollTo({top:0, behavior:'smooth'})); } document.addEventListener('DOMContentLoaded', function(){ initMenu(); initBackToTop(); }); })(); } ; if(!window.__gb_theme_fix_v11_3){ window.__gb_theme_fix_v11_3 = true; (function(){ const root = document.documentElement; const THEME_KEY = 'gb_theme'; const qAll = (sel)=> Array.from(document.querySelectorAll(sel)); const get = ()=> (root.getAttribute('data-theme')||'').trim(); const set = (mode)=>{ root.setAttribute('data-theme', mode); try{ localStorage.setItem(THEME_KEY, mode); }catch(e){} root.classList.add('theme-animating'); clearTimeout(window.__gbThemeTimer); window.__gbThemeTimer = setTimeout(()=> root.classList.remove('theme-animating'), 340); qAll('#themeToggle,[data-theme-toggle]').forEach(el=>{ if(el.tagName==='INPUT' && (el.type==='checkbox' || el.type==='radio')){ el.checked = (mode==='dark'); }else if(!el.dataset.lockLabel){ el.textContent = (mode==='dark' ? '☀️' : '🌙'); el.title = (mode==='dark' ? 'الوضع الفاتح' : 'الوضع الداكن'); } }); }; const toggle = ()=> set(get()==='dark' ? 'light' : 'dark'); (function initOnce(){ const pre = get(); if(pre==='dark' || pre==='light'){ return; } let saved=null; try{ saved = localStorage.getItem(THEME_KEY); }catch(e){} if(saved==='dark' || saved==='light'){ set(saved); } else{ const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches; set(prefersDark ? 'dark' : 'light'); } })(); function bindThemeDelegation(){ const handler = (e)=>{ const t = e.target.closest('#themeToggle,[data-theme-toggle]'); if(!t) return; e.preventDefault(); e.stopPropagation(); toggle(); }; document.addEventListener('touchstart', handler, {passive:false}); document.addEventListener('click', handler); document.addEventListener('change', (e)=>{ const t = e.target.closest('#themeToggle,[data-theme-toggle]'); if(!t) return; if(t.tagName==='INPUT' && (t.type==='checkbox' || t.type==='radio')){ set(t.checked ? 'dark' : 'light'); } }); } document.addEventListener('DOMContentLoaded', bindThemeDelegation); window.addEventListener('pageshow', bindThemeDelegation); })(); } (function(){"use strict";const $=(sel,ctx=document)=>ctx.querySelector(sel);const $$=(sel,ctx=document)=>Array.prototype.slice.call(ctx.querySelectorAll(sel));try{document.body.classList.add("ui-enhanced");}catch(e){}const THEME_KEY="ui-theme";function applyTheme(mode){try{const m=(mode==="dark"||mode==="light")?mode:"dark";document.documentElement.setAttribute("data-theme",m);localStorage.setItem(THEME_KEY,m);}catch(e){}}function getTheme(){try{return localStorage.getItem(THEME_KEY)|| "dark";}catch(e){return "dark";}}applyTheme(getTheme());try{if(!$(".ui-theme-fab")){const fab=document.createElement("button");fab.className="ui-theme-fab";fab.type="button";fab.setAttribute("aria-label","Toggle Theme");fab.innerHTML='<svg width="22" height="22" viewBox="0 0 24 24" aria-hidden="true"><path d="M21.64 13A9 9 0 1111 2.36 7 7 0 0021.64 13z"/></svg>';fab.addEventListener("click",function(){const next=(getTheme()==="dark")?"light":"dark";applyTheme(next);},{passive:true});document.body.appendChild(fab);}}catch(e){console.warn(e);}try{const header=$("header")|| $(".header")|| $("#header");if(header){header.classList.add("ui-header");const onScroll=()=>{header.classList.toggle("is-scrolled",window.scrollY>6);};window.addEventListener("scroll",onScroll,{passive:true});onScroll();}}catch(e){}try{$$("[data-ui-toggle]").forEach(btn=>{btn.addEventListener("click",function(){const tgt=document.querySelector(this.getAttribute("data-ui-toggle"));if(!tgt)return;const isOpen=tgt.getAttribute("aria-expanded")==="true";tgt.setAttribute("aria-expanded",String(!isOpen));tgt.classList.toggle("ui-open",!isOpen);},{passive:true});});}catch(e){}function enhanceTables(){try{$$(".ui-table,table.ui-table,table[data-ui='table']").forEach(tbl=>{const heads=$$("thead th",tbl).map(th=>(th.textContent||"").trim());if(!heads.length)return;$$("tbody tr",tbl).forEach(tr=>{$$("td",tr).forEach((td,idx)=>{if(!td.hasAttribute("data-label")&& heads[idx])td.setAttribute("data-label",heads[idx]);});});});}catch(e){}}enhanceTables();window.addEventListener("resize",function(){enhanceTables();},{passive:true});try{$$("img").forEach(img=>{if(!img.hasAttribute("loading"))img.setAttribute("loading","lazy");img.setAttribute("decoding","async");});}catch(e){}})();(function(){try{var h=document.querySelector('header')||document.querySelector('.header')||document.querySelector('#header');if(!h)return;var last=window.scrollY||0,ticking=false,hidden=false,delta=8;function evalDir(){var y=window.scrollY||0;if(Math.abs(y-last)<=delta){last=y;return;}if(y>last&&y>64){if(!hidden){h.classList.add('ui-hide');hidden=true;}}else{if(hidden){h.classList.remove('ui-hide');hidden=false;}}last=y;}window.addEventListener('scroll',function(){if(!ticking){window.requestAnimationFrame(function(){evalDir();ticking=false;});ticking=true;}},{passive:true});}catch(e){}})();(function(){try{var h=document.querySelector('header')||document.querySelector('.header')||document.querySelector('#header');function setHH(){try{var hh=h?Math.max(0,Math.round(h.getBoundingClientRect().height))||64:64;document.documentElement.style.setProperty('--ui-header-h',hh+'px');}catch(e){}}setHH();window.addEventListener('resize',function(){setHH();},{passive:true});var togglers=[].slice.call(document.querySelectorAll('[data-ui-toggle]'));function looksLikeMenu(el){if(!el)return false;var s=(el.className||'')+' '+(el.id||'');s=s.toLowerCase();return el.tagName.toLowerCase()==='nav'||el.getAttribute('role')==='navigation'||/menu|sidebar|drawer|offcanvas/.test(s);}togglers.forEach(function(btn){btn.addEventListener('click',function(){try{var tgt=document.querySelector(btn.getAttribute('data-ui-toggle'));if(!tgt)return;var opening=tgt.classList.contains('ui-open');opening=!opening;if(looksLikeMenu(tgt)){tgt.classList.add('ui-drawer');setHH();if(opening){document.body.classList.add('ui-menu-open');if(h)h.classList.add('ui-hide');}else{document.body.classList.remove('ui-menu-open');if(h)h.classList.remove('ui-hide');}}}catch(e){}},{passive:true});});}catch(e){}})();(function(){try{var h=document.querySelector('header')||document.querySelector('.header')||document.querySelector('#header');if(h){h.setAttribute('data-hide-driver','smooth');}var last=window.scrollY||0;var delta=10;var topHold=96;function onScrollSmooth(){try{if(!h)return;var y=window.scrollY||0;var diff=y-last;var down=diff>0;if(y<=topHold){h.classList.remove('ui-allow');h.classList.remove('ui-hide');}else{if(down&&diff>delta){h.classList.add('ui-allow');}else if(!down&&Math.abs(diff)>delta){h.classList.remove('ui-allow');h.classList.remove('ui-hide');}}last=y;}catch(e){}}window.addEventListener('scroll',function(){window.requestAnimationFrame(onScrollSmooth)},{passive:true});}catch(e){}})();(function(){try{var path=(location.pathname||'').toLowerCase();var isHome=(path==='/'||/index\.(php|html)$/.test(path));if(!isHome)return;var scr=document.createElement('div');scr.className='ui-loader-screen';scr.innerHTML='<div class="ui-loader-brand"><div class="ui-loader-dot"></div><div class="ui-loader-name">جارِ التحميل…</div></div>';document.addEventListener('DOMContentLoaded',function(){try{document.body.appendChild(scr);}catch(e){}});window.addEventListener('load',function(){try{scr.classList.add('ui-loader-hide');setTimeout(function(){if(scr&&scr.parentNode){scr.parentNode.removeChild(scr);}},280);}catch(e){}});}catch(e){}})();(function(){try{var h=document.querySelector('header')||document.querySelector('.header')||document.querySelector('#header');var body=document.body;function keepHeaderIfMenu(){try{if(!h)return; if(body.classList.contains('ui-menu-open')){h.classList.remove('ui-hide');h.classList.remove('ui-allow');}}catch(e){}}document.addEventListener('click',function(ev){try{if(ev.target.closest('[data-ui-toggle]')){setTimeout(keepHeaderIfMenu,0);}}catch(e){}},true);window.addEventListener('scroll',function(){try{if(body.classList.contains('ui-menu-open')){if(h){h.classList.remove('ui-hide');h.classList.remove('ui-allow');}}}catch(e){}},{passive:true});}catch(e){}})();(function(){try{var h=document.querySelector('header')||document.querySelector('.header')||document.querySelector('#header');if(!h)return;var last=window.scrollY||0, delta=22, topHold=140, rafing=false;function smoothCtrl(){try{var y=window.scrollY||0;var diff=y-last;var down=diff>0;if(y<=topHold){h.classList.remove('ui-allow');h.classList.remove('ui-hide');}else{if(down&&diff>delta){h.classList.add('ui-allow');}else if(!down&&Math.abs(diff)>delta){h.classList.remove('ui-allow');h.classList.remove('ui-hide');}}last=y;}catch(e){}}window.addEventListener('scroll',function(){if(!rafing){window.requestAnimationFrame(function(){smoothCtrl();rafing=false;});rafing=true;}},{passive:true});}catch(e){}})();(function(){try{var path=(location.pathname||'').toLowerCase();var isHome=(path==='/'||/index\.(php|html)$/.test(path));if(!isHome)return;function hideLoaderSoon(){try{var scr=document.querySelector('.ui-loader-screen');if(!scr)return;scr.classList.add('ui-loader-hide');setTimeout(function(){if(scr&&scr.parentNode){scr.parentNode.removeChild(scr);}},160);}catch(e){}}if(document.readyState==='interactive'||document.readyState==='complete'){hideLoaderSoon();}else{document.addEventListener('DOMContentLoaded',hideLoaderSoon);}window.addEventListener('load',hideLoaderSoon,{once:true});}catch(e){}})();(function(){try{var h=document.querySelector('header')||document.querySelector('.header')||document.querySelector('#header');if(!h)return;var last=window.scrollY||0, delta=26, topHold=120, rafing=false;function ctrl(){try{var y=window.scrollY||0;var diff=y-last;var down=diff>0;if(y<=topHold){h.classList.remove('ui-allow');h.classList.remove('ui-hide');}else{if(down&&diff>delta){h.classList.add('ui-allow');h.classList.add('ui-hide');}else if(!down&&Math.abs(diff)>delta){h.classList.remove('ui-allow');h.classList.remove('ui-hide');}}last=y;}catch(e){}}window.addEventListener('scroll',function(){if(!rafing){window.requestAnimationFrame(function(){ctrl();rafing=false;});rafing=true;}},{passive:true});}catch(e){}})();(function(){try{var h=document.querySelector('header')||document.querySelector('.header')||document.querySelector('#header');var body=document.body;function updateForMenu(tgt){try{var opened=!!(tgt&&tgt.classList&&tgt.classList.contains('ui-open'));if(opened){body.classList.add('ui-menu-open');if(h){h.classList.add('ui-hide');}}else{body.classList.remove('ui-menu-open');if(h){h.classList.remove('ui-hide');}}}catch(e){}}document.addEventListener('click',function(ev){try{var btn=ev.target.closest('[data-ui-toggle]');if(!btn)return;setTimeout(function(){try{var tgt=document.querySelector(btn.getAttribute('data-ui-toggle'));updateForMenu(tgt);}catch(e){}},0);}catch(e){}},true);window.addEventListener('scroll',function(){try{if(body.classList.contains('ui-menu-open')){if(h)h.classList.add('ui-hide');}}catch(e){}},{passive:true});}catch(e){}})();(function(){try{var path=(location.pathname||'').toLowerCase();var isHome=(path==='/'||/index\.(php|html)$/.test(path));if(!isHome)return;function ensureLoader(){try{var scr=document.querySelector('.ui-loader-screen');if(!scr){scr=document.createElement('div');scr.className='ui-loader-screen';scr.innerHTML='<div class="ui-loader-brand"><div class="ui-loader-dot"></div><div class="ui-loader-name">جارِ التحميل…</div></div>';document.body.appendChild(scr);}return scr;}catch(e){return null;}}function hideAfter(ms){try{var scr=ensureLoader();if(!scr)return;setTimeout(function(){try{scr.classList.add('ui-loader-hide');setTimeout(function(){if(scr&&scr.parentNode){scr.parentNode.removeChild(scr);}},260);}catch(e){}},ms);}catch(e){}}if(document.readyState==='loading'){document.addEventListener('DOMContentLoaded',function(){hideAfter(2000);});}else{hideAfter(2000);}}catch(e){}})();(function(){try{var h=document.querySelector('header')||document.querySelector('.header')||document.querySelector('#header');if(!h)return;function setHH(){try{var hh=h.getBoundingClientRect().height||64;document.documentElement.style.setProperty('--ui-header-h',Math.round(hh)+'px');}catch(e){}}setHH(); window.addEventListener('resize', setHH, {passive:true});h.classList.remove('ui-hide'); h.style.transform='';window.addEventListener('scroll', function(){try{h.classList.remove('ui-hide');}catch(e){}}, {passive:true});}catch(e){}})(); (function(){ "use strict"; const $ = (sel, ctx=document)=>ctx.querySelector(sel); const $$ = (sel, ctx=document)=>Array.prototype.slice.call(ctx.querySelectorAll(sel)); const THEME_KEY="ui-theme"; function applyTheme(mode){ const m=(mode==="light"||mode==="dark")?mode:"dark"; document.documentElement.setAttribute("data-theme",m); try{localStorage.setItem(THEME_KEY,m);}catch(e){} } function getTheme(){ try{return localStorage.getItem(THEME_KEY)||"dark";}catch(e){return "dark";} } try { $$("#theme-toggle,.theme-toggle,[data-theme-toggle]").forEach(btn=>{ btn.addEventListener("click",()=>applyTheme(getTheme()==="dark"?"light":"dark")); }); } catch(e){} try{ applyTheme(getTheme()); }catch(e){} try { const header = $("header.site-header") || $(".site-header") || $("header[role='banner']") || $("header"); const bottom = $(".site-bottombar") || $(".bottom-bar") || $(".mobile-bottom-bar"); const mode = (document.body.getAttribute("data-header-mode")||"auto").toLowerCase(); if (header) { let lastY=window.scrollY, ticking=false; const onScroll=()=>{ const y=window.scrollY; const down = y>lastY; const past = y>56; if (mode==="fixed"){ header.classList.remove("is-hidden"); if (bottom) bottom.classList.remove("is-hidden"); } else { if (past && down){ header.classList.add("is-hidden"); if (bottom) bottom.classList.add("is-hidden"); } else { header.classList.remove("is-hidden"); if (bottom) bottom.classList.remove("is-hidden"); } } lastY=y; ticking=false; }; document.addEventListener("scroll",()=>{ if(!ticking){ window.requestAnimationFrame(onScroll); ticking=true; } }, {passive:true}); onScroll(); } } catch(e){} })(); (function(){ "use strict"; const $ = (s,c=document)=>c.querySelector(s); const $$ = (s,c=document)=>Array.prototype.slice.call(c.querySelectorAll(s)); const REDUCED = window.matchMedia ? window.matchMedia("(prefers-reduced-motion: reduce)").matches : false; try{ document.addEventListener("click", function(ev){ const btn = ev.target.closest(".btn"); if(!btn) return; if(REDUCED) return; const rect = btn.getBoundingClientRect(); const r = Math.max(rect.width, rect.height); const x = ev.clientX - rect.left - r/2; const y = ev.clientY - rect.top - r/2; const ripple = document.createElement("span"); ripple.className = "ripple"; ripple.style.cssText = "position:absolute;inset:auto;pointer-events:none;border-radius:999px;background:rgba(255,255,255,.35);width:"+r+"px;height:"+r+"px;left:"+x+"px;top:"+y+"px;transform:scale(0);opacity:.7;transition:transform .5s ease,opacity .6s ease;"; btn.appendChild(ripple); requestAnimationFrame(()=>{ ripple.style.transform = "scale(1.8)"; ripple.style.opacity = "0"; }); setTimeout(()=>{ ripple.remove(); }, 650); }, {passive:true}); }catch(e){} try{ const els = $$(".sr"); if(els.length){ const io = new IntersectionObserver((entries)=>{ entries.forEach(e=>{ if(e.isIntersecting){ e.target.classList.add("sr-in"); io.unobserve(e.target); } }); }, {root:null, rootMargin:"0px 0px -10% 0px", threshold:.1}); els.forEach(el=>io.observe(el)); } }catch(e){} try{ document.addEventListener("click", function(e){ const a = e.target.closest('a[href^="#"]'); if(!a) return; const id = a.getAttribute("href").slice(1); if(!id) return; const target = document.getElementById(id); if(!target) return; e.preventDefault(); target.scrollIntoView({behavior: REDUCED ? "auto" : "smooth", block:"start"}); }); }catch(e){} try{ const wrap = document.createElement("div"); wrap.className = "toast-wrap"; document.addEventListener("DOMContentLoaded", ()=>{ document.body.appendChild(wrap); }); window.UI = window.UI || {}; window.UI.toast = function(msg, type){ const t = document.createElement("div"); t.className = "toast " + (type||"info"); t.textContent = msg; wrap.appendChild(t); requestAnimationFrame(()=> t.classList.add("show")); setTimeout(()=>{ t.classList.remove("show"); setTimeout(()=> t.remove(), 250); }, 2800); }; }catch(e){} try{ document.addEventListener("keydown", function(e){ if(e.key !== "Escape") return; const openPanel = document.querySelector("[data-ui-panel]:not(.u-hidden)"); if(openPanel) openPanel.classList.add("u-hidden"); }); }catch(e){} })();