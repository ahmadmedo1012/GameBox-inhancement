(function(){ 'use strict'; // Remove any dynamically inserted back-to-top buttons (function(){var s=['.scroll-top','.back-to-top','.to-top','#toTop','[data-scroll-top]','[aria-label*="Ø§Ù„Ø£Ø¹Ù„Ù‰"]','[aria-label*="Ù„Ø£Ø¹Ù„Ù‰"]'];function n(){try{s.forEach(function(sel){document.querySelectorAll(sel).forEach(function(el){el.remove();});});}catch(e){}}if(document.readyState!=='loading')n();else document.addEventListener('DOMContentLoaded',n);setTimeout(n,0);})(); function ensureFab(){ var headerToggle = document.getElementById('themeToggle'); var fab = document.getElementById('gbThemeFab'); if(!fab){ fab = document.createElement('button'); fab.id = 'gbThemeFab'; fab.className = 'gb-theme-fab'; fab.type = 'button'; fab.setAttribute('aria-label','ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„ÙˆØ¶Ø¹'); fab.setAttribute('title','ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„ÙˆØ¶Ø¹'); fab.setAttribute('data-theme-toggle',''); fab.textContent = 'ðŸŒ™'; document.body.appendChild(fab); } // clicking the fab should toggle theme by emulating existing handler or setting data-theme directly var root = document.documentElement; function setTheme(mode){ root.setAttribute('data-theme', mode); try{localStorage.setItem('gb_theme', mode);}catch(e){} } fab.addEventListener('click', function(e){ e.preventDefault(); e.stopPropagation(); var next = (root.getAttribute('data-theme')==='dark' ? 'light' : 'dark'); setTheme(next); }, true); return fab; } function syncWithTabbar(fab){ var tabbar = document.querySelector('.smart-tabbar'); if (tabbar){ var apply = function(){ fab.classList.toggle('hide', tabbar.classList.contains('hide')); }; var mo = new MutationObserver(apply); mo.observe(tabbar, {attributes:true, attributeFilter:['class']}); apply(); }else{ var lastY = window.scrollY, ticking=false; function onScroll(){ var y = window.scrollY; if (y > lastY + 8) fab.classList.add('hide'); else if (y < lastY - 8 || y < 10) fab.classList.remove('hide'); lastY = y; ticking=false; } window.addEventListener('scroll', function(){ if(!ticking){ window.requestAnimationFrame(onScroll); ticking=true; } }, {passive:true}); } } function init(){ var fab = ensureFab(); syncWithTabbar(fab); } if(document.readyState!=='loading') init(); else document.addEventListener('DOMContentLoaded', init); })();